---
name: Prisma Removal - Rewrite Better Auth Configuration
status: open
created: 2026-01-13T14:41:59Z
updated: 2026-01-13T14:41:59Z
github: [Will be updated when synced to GitHub]
depends_on: [004]
parallel: false
---

# Task: Prisma Removal - Rewrite Better Auth Configuration

## Description

Rewrite `lib/auth.ts` to use direct PostgreSQL connection via pg Pool instead of Prisma adapter. This removes the Prisma dependency while preserving all Better Auth configuration, field mappings, and custom functionality. Better Auth will automatically use database-generated UUIDs with the PostgreSQL adapter.

## Checklist

- [ ] Backup current `lib/auth.ts` to `lib/auth.ts.backup`
- [ ] Remove all Prisma imports (prismaAdapter, PrismaClient, PrismaPg)
- [ ] Create PostgreSQL Pool with Supabase connection string
- [ ] Configure Better Auth to use Pool directly (database: pool)
- [ ] Verify Better Auth uses gen_random_uuid() by default (no explicit generateId config)
- [ ] Preserve all field mappings (users, sessions, oauth_providers, etc.)
- [ ] Preserve all custom configuration (email verification, OAuth, rate limiting, etc.)
- [ ] Add comments explaining direct connection and UUID generation
- [ ] Update imports to remove Prisma dependencies
- [ ] Verify TypeScript types still infer correctly (Session, User types)
- [ ] Tests written (update auth service tests)
- [ ] All tests passing (npm run test:unit for auth)
- [ ] Code reviewed

## Reference

See epic.md sections:
- "Part 2: Prisma Removal - Simplified Better Auth Configuration" for complete rewritten config
- "Migration Steps Phase 2: Step 7" for key changes required
- "Architecture Decisions #2" for rationale

## Dependencies

- Task 004: UUID migration must be complete and documented first

## Effort: Medium (2-3 hours)
