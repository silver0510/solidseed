---
name: UUID Migration - Database Schema Conversion
status: open
created: 2026-01-13T14:41:59Z
updated: 2026-01-13T14:41:59Z
github: [Will be updated when synced to GitHub]
depends_on: []
parallel: false
---

# Task: UUID Migration - Database Schema Conversion

## Description

Create and apply database migration to convert all 12 tables from VARCHAR(255) to native PostgreSQL UUID type with gen_random_uuid() defaults. This includes all primary keys and foreign key columns across authentication and client hub tables.

## Checklist

- [ ] Run pre-migration validation query to confirm all existing IDs are valid UUID format
- [ ] Create migration file: `supabase/migrations/20260114000001_migrate_to_uuid_type.sql`
- [ ] Include pgcrypto extension enablement
- [ ] Convert all 12 tables (users, oauth_providers, password_resets, email_verifications, auth_logs, verification, sessions, clients, client_tags, client_documents, client_notes, client_tasks)
- [ ] Convert all foreign key columns to UUID type
- [ ] Add gen_random_uuid() defaults to all primary key columns
- [ ] Update COMMENT statements for all ID columns
- [ ] Wrap entire migration in BEGIN/COMMIT transaction
- [ ] Apply migration with `supabase db push`
- [ ] Run post-migration validation query to verify UUID type
- [ ] Test UUID generation with INSERT query
- [ ] Update `.claude/database/database.dbml` to reflect UUID types
- [ ] All verification checks passing

## Reference

See epic.md sections:
- "Part 1: UUID Migration (Database Layer)" for complete migration SQL
- "Migration Steps Phase 1: Step 1-3" for validation and application steps
- "Architecture Decisions #1" for rationale and migration impact

## Dependencies

None - This is the foundation task that other tasks depend on

## Effort: Medium (3-4 hours)
