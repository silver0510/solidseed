---
name: setup-google-oauth
status: complete
created: 2026-01-07T02:57:01Z
updated: 2026-01-07T15:30:59Z
github: null
depends_on: [001]
parallel: true
conflicts_with: []
---

# Task: Set up Google OAuth credentials

## Description

Configure Google Cloud Platform OAuth 2.0 credentials for social authentication. Create a GCP project, set up OAuth consent screen, generate client credentials, and document the redirect URI configuration for Better Auth integration.

## Acceptance Criteria

- [ ] Google Cloud Platform project created
- [ ] OAuth consent screen configured with app details
- [ ] OAuth 2.0 credentials generated (client ID and secret)
- [ ] Credentials added to `.env.local`
- [ ] Redirect URI documented and configured
- [ ] Test OAuth flow (manual verification)
- [ ] Setup process documented in README
- [ ] Production OAuth setup instructions added

## Technical Details

### Implementation Steps

**1. Create Google Cloud Project**

```bash
# Go to Google Cloud Console
# https://console.cloud.google.com/

# Steps:
# 1. Click "Select a project" → "New Project"
# 2. Project name: "SolidSeed CRM"
# 3. Organization: (your org or leave blank)
# 4. Click "Create"
# 5. Wait for project creation (takes ~30 seconds)
```

**2. Enable Google+ API**

```bash
# In Google Cloud Console:
# 1. Go to "APIs & Services" → "Library"
# 2. Search for "Google+ API"
# 3. Click "Enable"
#
# Also enable:
# - "Google People API" (for user profile data)
```

**3. Configure OAuth Consent Screen**

```bash
# Go to "APIs & Services" → "OAuth consent screen"

# User Type: External (for testing) → Internal (for production)
# Click "Create"

# App Information:
App name: SolidSeed CRM
User support email: your-email@example.com
Application home page: http://localhost:3000 (dev) / https://solidseed.app (prod)
Application privacy policy: https://solidseed.app/privacy (prod)
Application terms of service: https://solidseed.app/terms (prod)

# Developer contact information:
Email addresses: your-email@example.com

# Scopes (click "Add or Remove Scopes"):
- .../auth/userinfo.email (See your email address)
- .../auth/userinfo.profile (See your personal info)
- openid (Associate you with your personal info on Google)

# Test users (for External apps):
# Add your email and test user emails

# Click "Save and Continue"
```

**4. Create OAuth 2.0 Credentials**

```bash
# Go to "APIs & Services" → "Credentials"
# Click "Create Credentials" → "OAuth client ID"

# Application type: Web application
# Name: SolidSeed CRM - Web Client

# Authorized JavaScript origins:
http://localhost:3000
http://localhost:3001
https://solidseed.app (production)
https://www.solidseed.app (production)

# Authorized redirect URIs:
http://localhost:3000/api/auth/callback/google
http://localhost:3001/api/auth/callback/google
https://solidseed.app/api/auth/callback/google (production)
https://www.solidseed.app/api/auth/callback/google (production)

# Click "Create"
# Copy Client ID and Client Secret
```

**5. Add Credentials to Environment**

```bash
# Add to .env.local
cat >> .env.local << 'EOF'

# Google OAuth
GOOGLE_CLIENT_ID=your-client-id-here.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=GOCSPX-your-client-secret-here
EOF
```

**6. Update .env.example**

```bash
# Add to .env.example (with placeholder values)
cat >> .env.example << 'EOF'

# Google OAuth (Get from Google Cloud Console)
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
EOF
```

**7. Document Setup Process**

````markdown
# Add to README.md under "OAuth Setup"

## Google OAuth Setup

### Development Setup

1. **Create Google Cloud Project**
   - Go to [Google Cloud Console](https://console.cloud.google.com/)
   - Create new project: "SolidSeed CRM"

2. **Enable APIs**
   - Enable "Google+ API"
   - Enable "Google People API"

3. **Configure OAuth Consent Screen**
   - User Type: External
   - App name: SolidSeed CRM
   - User support email: your-email@example.com
   - Scopes: email, profile, openid

4. **Create OAuth Credentials**
   - Type: Web application
   - Authorized origins: `http://localhost:3000`
   - Redirect URI: `http://localhost:3000/api/auth/callback/google`

5. **Add Credentials to .env.local**
   ```bash
   GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
   GOOGLE_CLIENT_SECRET=GOCSPX-your-secret
   ```
````

### Production Setup

1. **Update OAuth Consent Screen**
   - Change User Type to "Internal" (if workspace) or keep "External"
   - Add production URLs:
     - Homepage: https://solidseed.app
     - Privacy policy: https://solidseed.app/privacy
     - Terms of service: https://solidseed.app/terms

2. **Update Redirect URIs**
   - Add: `https://solidseed.app/api/auth/callback/google`
   - Add: `https://www.solidseed.app/api/auth/callback/google`

3. **Submit for Verification** (if External)
   - Required for production use with External user type
   - Submit app for Google verification
   - Provide app details and privacy policy

### Redirect URI Format

Better Auth expects the redirect URI in this format:

```
{APP_URL}/api/auth/callback/google
```

Where `APP_URL` is your application URL:

- Development: `http://localhost:3000`
- Production: `https://solidseed.app`

### Testing OAuth Flow

1. Start development server: `npm run dev`
2. Navigate to: `http://localhost:3000/auth/signin`
3. Click "Sign in with Google"
4. You should be redirected to Google OAuth consent screen
5. After consent, redirected back to your app

### Troubleshooting

**Error: "redirect_uri_mismatch"**

- Ensure redirect URI in Google Console exactly matches Better Auth callback URL
- Check for trailing slashes (should not have one)
- Verify APP_URL environment variable is correct

**Error: "Access blocked: This app's request is invalid"**

- OAuth consent screen not configured properly
- Missing required scopes (email, profile, openid)

**Error: "This app isn't verified"**

- Normal for development with External user type
- Add test users in OAuth consent screen
- Or submit app for verification for production

````

### Key Files Created/Modified
- `.env.local` - Add Google OAuth credentials
- `.env.example` - Add placeholder values
- `README.md` - Document OAuth setup process
- Google Cloud Console - Project and OAuth configuration

## Dependencies

### Depends On
- Task 001: Environment setup and .env.local file must exist

### Blocks
- Task 009: Environment validation will check Google OAuth credentials

## Effort Estimate
- **Size**: S
- **Hours**: 1-1.5 hours
- **Parallel**: true (can work alongside storage and email setup)

## Definition of Done
- [x] Google Cloud project created
- [x] OAuth consent screen configured
- [x] Client ID and secret generated
- [x] Credentials in .env.local
- [x] Redirect URIs documented
- [x] README updated with setup instructions
- [x] Production setup process documented

## Validation Commands
```bash
# Verify environment variables are set
if grep -q "GOOGLE_CLIENT_ID" .env.local && grep -q "GOOGLE_CLIENT_SECRET" .env.local; then
  echo "✅ Google OAuth credentials found in .env.local"
else
  echo "❌ Missing Google OAuth credentials"
fi

# Check .env.example has placeholders
if grep -q "GOOGLE_CLIENT_ID" .env.example && grep -q "GOOGLE_CLIENT_SECRET" .env.example; then
  echo "✅ Google OAuth placeholders in .env.example"
else
  echo "❌ Missing Google OAuth placeholders in .env.example"
fi

# Verify README has OAuth documentation
if grep -q "Google OAuth Setup" README.md; then
  echo "✅ Google OAuth setup documented"
else
  echo "❌ Missing OAuth documentation in README"
fi

# Test OAuth flow (manual)
# 1. Start dev server: npm run dev
# 2. Open browser: http://localhost:3000
# 3. Navigate to sign-in page
# 4. Click "Sign in with Google"
# 5. Verify redirect to Google OAuth consent screen
# 6. After consent, verify redirect back to app
# 7. Check for successful authentication
````

## Troubleshooting

**Issue: "Invalid client ID"**

- Double-check client ID copied correctly from Google Console
- Ensure no extra spaces or line breaks
- Verify the OAuth client is for "Web application" type

**Issue: "redirect_uri_mismatch"**

- Exact match required between Google Console and Better Auth callback
- Format: `http://localhost:3000/api/auth/callback/google`
- No trailing slash
- Check protocol (http vs https)

**Issue: "This app isn't verified" warning**

- Normal for development
- Add test users to OAuth consent screen
- For production, submit verification or use Internal user type

**Issue: "Access blocked: This app's request is invalid"**

- Ensure OAuth consent screen is fully configured
- Add all required scopes: email, profile, openid
- Save and publish consent screen

**Issue: Google+ API deprecated warning**

- Ignore for now, Google People API is the replacement
- Better Auth uses People API for profile data
- No action needed

## Next Steps

After completing this task:

1. Test OAuth flow with Better Auth (in Task 009)
2. Set up Microsoft OAuth (if needed)
3. Configure OAuth session handling
4. Add OAuth error handling to sign-in page
5. Test with multiple Google accounts
6. Prepare for production verification process
