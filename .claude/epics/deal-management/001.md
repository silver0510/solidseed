---
name: Database Schema and Migrations
status: in-progress
created: 2026-01-24T14:08:03Z
updated: 2026-01-24T14:20:40Z
github: [Will be updated when synced to GitHub]
depends_on: []
parallel: true
---

# Task: Database Schema and Migrations

## Description

Create Supabase migration for all deal management tables (deal_types, deals, deal_milestones, deal_documents, deal_activities) with indexes, constraints, RLS policies, and seed data for Residential Sale and Mortgage Loan deal types.

## Checklist

- [x] Create migration file with all 5 tables and constraints
- [x] Add all indexes (including GIN index on deal_data JSONB)
- [x] Configure RLS policies for user-scoped access
- [x] Insert seed data for residential_sale and mortgage deal types
- [ ] Push migration to Supabase: `supabase db push`
- [ ] Verify tables in Supabase Dashboard
- [x] Update .claude/database/database.dbml with new tables
- [ ] Tests written for schema validation
- [ ] All tests passing

## Reference

See epic.md sections:
- "Database Schema" for complete SQL (lines 101-413)
- "DBML Addition" for documentation format (lines 417-580)

## Dependencies

- Existing `users` and `clients` tables must exist
- Supabase project configured with auth

## Effort: Medium (4 hours)
